<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conversation</title>
    <style>
        {% include 'css/basic.css' %}
    </style>
</head>
<body>

<div class="container">

    <!-- Conversation Header -->
    <div class="conversation-header">
        <h3>Conversation between {{ user_name }} and {{ system_name }}</h3>
        <p>Started at: {{ started_at }}</p>
        <p>ID: {{ conversation_id }}, Model: {{embedding_model}}, Dimensions: {{embedding_dimensions}}</p>
    </div>

    <!-- Conversation History -->
    <div class="conversation-history">
        {% for message in conversation_history %}
            <div class="message {% if message.sender == 'user' %}user-message{% else %}system-message{% endif %}">
                <div class="sender">{{ message.name|title }}:</div>
                <div class="text">{{ message.text }}</div>
            </div>
        {% endfor %}
    </div>

    <!-- Input Form for User Message -->
    <form method="post" action="{% url 'conversation' conversation_id %}" class="input-form">
        {% csrf_token %}
        <input type="text" id="user_message" name="user_message" placeholder="Type your message here" required>
        <button type="submit">Send</button>
    </form>

</div>

<div class="container">
    <!-- Header -->
    <div class="conversation-header">
        <h3>Start a New Conversation</h3>
    </div>

    <form method="post" action="{% url 'conversation' 'new' %}" class="input-form">
        {% csrf_token %}
        <div class="input-field">
            <label for="model">Choose a model:</label>
            <select id="model" name="selected_model" required>
                <option value="" disabled selected>Choose your option</option>
                {% for model in available_models %}
                    <option value="{{ model.id }}">{{ model.name }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="input-field">
            <label for="dimensions">dimensions:</label>
            <select id="dimensions" name="selected_dimensions" required>
                <option value="" disabled selected>Choose your option</option>
                {% for dimension in available_dimensions %}
                    <option value="{{ dimension.id }}">{{ dimension.dimension }}</option>
                {% endfor %}
            </select>
        </div>
        <div>
            <button type="submit">Start Conversation</button>
        </div>
    </form>
</div>

</body>
</html>